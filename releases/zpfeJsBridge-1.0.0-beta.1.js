/*!
* JsBridge@1.0.0-beta.1
* (c) 2018-2018 github.com
*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.JsBridge=t()}(this,function(){"use strict";var r=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e};var s=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),i.forEach(function(e){r(t,e,n[e])})}return t};var n=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")};function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var e=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e},t=function(){function t(e){if(n(this,t),r(this,"jsBridgePrefix","JsBridge"),r(this,"nativeReceiveEventName","NativeReceiveEvent"),r(this,"callbacks",{}),r(this,"events",{}),r(this,"jsEngine","webkit"),r(this,"id",0),!(this instanceof t))return new t(e);window["".concat(this.jsBridgePrefix,"Receive")]=this.receive}return e(t,[{key:"invoke",value:function(e,t,n){var i=window[this.jsEngine].messageHandlers[e];return i&&(i.postMessage(s({},t,{callbackId:++this.id})),n&&(this.callbacks[this.id]=n)),this}},{key:"receive",value:function(e){var t=e.eventName,n=e.callbackId,i=e.responseId,r=e.data;if(n)this.callbacks[n]&&this.callbacks[n]();else if(t){var s=this.emit(t,r);this.invoke(this.nativeReceiveEventName,{result:s,responseId:i})}}},{key:"emit",value:function(e,n){if(!this.events[e])return this;var i={};return this.events[e].forEach(function(e){var t=e(n);Object.assign(i,t)}),i}},{key:"on",value:function(e,t){if(e&&t)return this.events[e]=this.events[e]||[],this.events[e].push(t),this}},{key:"off",value:function(t,n){var i=this;if(!t||!this.events[t])return this;if(!n)return delete this.events[t],this;var r=[];return this.events[t].forEach(function(e){i.events[t]!==n&&r.push(e)}),this.events[t]=r,this}}]),t}();return console.log("__DEBUG_MODE__",!1),t});
